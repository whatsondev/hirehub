!function(e){e.fn.noo_upload=function(a){var i={max_file_size:"2mb",runtimes:"html5,flash,html4",multipart:!0,urlstream_upload:!0,max_files:0,upload_enabled:!0,multi_upload:!1,url:nooUpload.url,delete_url:nooUpload.delete_url,flash_swf_url:nooUpload.flash_swf_url,resize:{}},t=(a=e.extend(i,a)).flash_swf_url,o=a.tag_thumb,l=e("#"+o),d=(a.input_name,a.multi_upload),n=new plupload.Uploader({browse_button:a.browse_button,file_data_name:"aaiu_upload_file",multi_selection:a.multi_upload,url:a.url,flash_swf_url:t,filters:[{title:"extensions",extensions:"jpg,jpeg,gif,png"}],resize:a.resize,views:{thumb:!0},init:{PostInit:function(){l.innerHTML=""},FilesAdded:function(i,t){plupload.each(t,(function(i){!1===d?e("#"+a.browse_button).parent().find(".noo_upload-status").get(0).innerHTML='<div id="'+i.id+'">'+i.name+" ("+plupload.formatSize(i.size)+") <b></b></div>":e("#"+a.browse_button).parent().find(".noo_upload-status").get(0).innerHTML+='<div id="'+i.id+'">'+i.name+" ("+plupload.formatSize(i.size)+") <b></b></div>"})),n.start()},UploadProgress:function(a,i){e("#"+i.id)&&(e("#"+i.id).find("b").get(0).innerHTML="<span>"+i.percent+"%</span>")},Error:function(e,a){!1===d?l.html("\nError #"+a.code+": "+a.message):l.get(0).innerHTML+="\nError #"+a.code+": "+a.message},FileUploaded:function(a,i,t){var o=e.parseJSON(t.response);if(e("#"+i.id).remove(),e(".jform-error",l).remove(),o.success){!1===d?(e(".image-upload-thumb",l).remove(),l.append('<div class="image-upload-thumb" data-id="'+o.image_id+'"><img width="150" src="'+o.image+'" /><a class="delete-uploaded" data-fileid="'+o.image_id+'" href="#" title="'+nooUpload.remove_txt+'"><i class="fa fa-times-circle"></i></a></div>')):l.append('<div class="image-upload-thumb" data-id="'+o.image_id+'"><img width="150" src="'+o.image+'" /><a class="delete-uploaded" data-fileid="'+o.image_id+'" href="#" title="'+nooUpload.remove_txt+'"><i class="fa fa-times-circle"></i></a></div>');var n=[];l.find(".image-upload-thumb").each((function(){var a=e(this).data("id");n.push(a)})),l.find(".noo-upload-value").val(n.join(",")).attr("value",n.join(","))}}}});n.init(),l.on("click",".image-upload-thumb .delete-uploaded",(function(a){a.preventDefault();var i=e(this),t={attach_id:i.data("fileid")};i.parent(".image-upload-thumb").remove(),e.post(nooUpload.delete_url,t);var o=[];return l.find(".image-upload-thumb").each((function(){var a=e(this).data("id");o.push(a)})),l.find(".noo-upload-value").val(o.join(",")).attr("value",o.join(",")),!1}))}}(jQuery);